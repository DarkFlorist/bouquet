{"version":3,"file":"ConfigureKeys.js","sourceRoot":"","sources":["../../ts/components/ConfigureKeys.tsx"],"names":[],"mappings":"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","sourcesContent":["import { batch, Signal, useSignal, useSignalEffect } from '@preact/signals'\nimport { Wallet } from 'ethers'\nimport { JSX } from 'preact/jsx-runtime'\nimport { ProviderStore } from '../library/provider.js'\nimport { BlockInfo, Bundle, Signers } from '../types/types.js'\n\nexport const ConfigureKeys = ({\n\tprovider,\n\tbundle,\n\tsigners,\n\tblockInfo,\n}: {\n\tprovider: Signal<ProviderStore | undefined>\n\tbundle: Signal<Bundle | undefined>\n\tsigners: Signal<Signers>\n\tblockInfo: Signal<BlockInfo>\n}) => {\n\tconst signerKeys = useSignal<{\n\t\t[address: string]: { input: string; wallet: Wallet | null }\n\t}>({})\n\n\tuseSignalEffect(() => {\n\t\tif (!bundle.value) signerKeys.value = {}\n\t\tif (bundle.value && bundle.value.uniqueSigners.join() !== Object.keys(signerKeys.value).join()) {\n\t\t\tsignerKeys.value = bundle.value.uniqueSigners.reduce((\n\t\t\t\t\tcurr: {\n\t\t\t\t\t\t[address: string]: { input: string; wallet: Wallet | null }\n\t\t\t\t\t},\n\t\t\t\t\taddress,\n\t\t\t\t) => {\n\t\t\t\t\tcurr[address] = { input: '', wallet: null }\n\t\t\t\t\treturn curr\n\t\t\t\t},\n\t\t\t\t{},\n\t\t\t)\n\t\t}\n\t})\n\n\tblockInfo.subscribe(() => {\n\t\tif (provider.value && signers.value.burner) {\n\t\t\tprovider.value.provider.getBalance(signers.value.burner.address).then((balance) => (signers.value.burnerBalance = balance))\n\t\t}\n\t})\n\n\tfunction tryUpdateSigners(address: string, privateKey: string) {\n\t\tbatch(() => {\n\t\t\ttry {\n\t\t\t\tconst wallet = new Wallet(privateKey)\n\n\t\t\t\tsignerKeys.value = {\n\t\t\t\t\t...signerKeys.peek(),\n\t\t\t\t\t[address]: {\n\t\t\t\t\t\twallet: wallet.address === address ? wallet : null,\n\t\t\t\t\t\tinput: privateKey,\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t} catch {\n\t\t\t\tsignerKeys.value = {\n\t\t\t\t\t...signerKeys.peek(),\n\t\t\t\t\t[address]: { wallet: null, input: privateKey },\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (Object.values(signerKeys.value).filter(({ wallet }) => !wallet).length === 0) {\n\t\t\t\tsigners.value = {\n\t\t\t\t\t...signers.peek(),\n\t\t\t\t\tbundleSigners: Object.values(signerKeys.peek()).reduce((acc: { [account: string]: Wallet }, wallet) => {\n\t\t\t\t\t\tif (wallet.wallet) {\n\t\t\t\t\t\t\tacc[wallet.wallet.address] = wallet.wallet\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn acc\n\t\t\t\t\t}, {}),\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t}\n\n\treturn (\n\t\t<div className='flex flex-col w-full gap-4'>\n\t\t\t<h3 className='text-2xl font-semibold'>Enter Private Keys For Signing Accounts</h3>\n\t\t\t{Object.keys(signerKeys.value).map((address) => (\n\t\t\t\t<div className={`flex flex-col justify-center border h-16 outline-none px-4 focus-within:bg-white/5 bg-transparent ${signerKeys.value[address].wallet ? 'border-green-400' : (signerKeys.peek()[address].input ? 'border-red-400' : 'border-white/50 focus-within:border-white/80')}`}>\n\t\t\t\t\t<span className='text-sm text-gray-500'>{address}</span>\n\t\t\t\t\t<input onInput={(e: JSX.TargetedEvent<HTMLInputElement>) => tryUpdateSigners(address, e.currentTarget.value)} value={signerKeys.value[address].input} type='text' className='bg-transparent outline-none placeholder:text-gray-600' placeholder={`Enter private key for account`} />\n\t\t\t\t</div>\n\t\t\t))}\n\t\t</div>\n\t)\n}\n"]}